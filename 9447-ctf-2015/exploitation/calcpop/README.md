# 9447 CTF 2015: calcpop

**Category:** Exploitation
**Points:** 80
**Solves:** 174
**Description:**

> See if you can pop *this* calc.
>
> Running at calcpop-4gh07blg.9447.plumbing port 9447
>
> [calcpop.tar.gz](./calcpop-42928687007cc7a92fc0ac6028cf8f64.tar.gz)  42928687007cc7a92fc0ac6028cf8f6


## Write-up

by [f0rki](https://github.com/f0rki)

We can connect to the challenge and send it two numbers, which it will add for
us. If we send something without a space, it will tell us the address of
our input, because instead of `%s` there is a `%p` in the format string:
```
Missing a space; your input was %p\n
```
Such a nice a infoleak. After some poking around I found that it is a straight
forward stack based buffer overflow:
```
$ python -c 'import sys; sys.stdout.write("A"*256)' | nc calcpop-4gh07blg.9447.plumbing 9447
Welcome to calc.exe
Missing a space; your input was 0xff8b44d0
Missing a space; your input was 0xff8b44d0
timeout: the monitored command dumped core
/usr/local/bin/ctf_wrapper.sh: line 6: 13607 Segmentation fault      timeout 300 $1 $2
```
Also using checksec we can see that `NX` is disabled.
```
$ checksec --file calcpop
RELRO           STACK CANARY      NX            PIE             RPATH      RUNPATH      FILE
Partial RELRO   No canary found   NX disabled   No PIE          No RPATH   No RUNPATH   calcpop
```
Yeah exploitation like it's the 90's. So we put shellcode on the stack and
overwrite the return address with the address we got from the infoleak. This is
pretty straightforward using a pwntools script.
[Here is the exploit.](exploit.py)


`9447{shELl_i5_easIEr_thaN_ca1c}`


## Other write-ups and resources

* <https://github.com/pwning/public-writeup/tree/master/9447ctf2015/pwn80-calcpop>
* <https://gist.github.com/emyei/97e22ee467fef6c97119>
* <https://gist.github.com/xyzz/9a5511ffa1ade17e7359#file-02-exploit-01-calcpop-md>
* [Spanish](http://mumei.strangled.net/post/4)
* [b01lers](https://b01lers.net/challenges/9447%20CTF%202015/calcpop/76/)
* <http://andrewdutcher.com/helium/9447-15-writeup/index.html>
